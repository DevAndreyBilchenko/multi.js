/*! multi.js 02-03-2021 */

var multi=function(){var e=function(e,t){var a=t.limit;if(a>-1){for(var n=0,r=0;r<e.options.length;r++)e.options[r].selected&&n++;if(n===a){this.disabled_limit=!0,"function"==typeof t.limit_reached&&t.limit_reached();for(r=0;r<e.options.length;r++){(l=e.options[r]).selected||l.setAttribute("disabled",!0)}}else if(this.disabled_limit){for(r=0;r<e.options.length;r++){var l;"false"===(l=e.options[r]).getAttribute("data-origin-disabled")&&l.removeAttribute("disabled")}this.disabled_limit=!1}}},t=function(t,a,n){var r,l,d,i=t.options[a.target.getAttribute("multi-index")];i.disabled||(i.selected=!i.selected,e(t,n),r="change",l=t,(d=document.createEvent("HTMLEvents")).initEvent(r,!1,!0),l.dispatchEvent(d))},a=function(e,t){if(t.selected_outer&&(e.wrapper.selected.innerHTML=""),e.wrapper.non_selected.innerHTML="",t.non_selected_header&&t.selected_header){var a=document.createElement("div"),n=document.createElement("div");a.className="header",n.className="header",a.innerText=t.non_selected_header,n.innerText=t.selected_header,e.wrapper.non_selected.appendChild(a),t.selected_outer&&e.wrapper.selected.appendChild(n)}if(e.wrapper.search)var r=e.wrapper.search.value;for(var l=null,d=null,i=0;i<e.options.length;i++){var s=e.options[i],o=s.value,c=s.textContent||s.innerText,p=document.createElement("a");if(p.tabIndex=0,p.className="item",p.innerText=c,p.setAttribute("role","button"),p.setAttribute("data-value",o),p.setAttribute("multi-index",i),s.disabled&&(p.className+=" disabled"),s.selected){p.className+=" selected";var u=p.cloneNode(!0);t.selected_outer&&e.wrapper.selected.appendChild(u)}if("OPTGROUP"==s.parentNode.nodeName&&s.parentNode!=d){if(d=s.parentNode,(l=document.createElement("div")).className="item-group",s.parentNode.label){var m=document.createElement("span");m.innerHTML=s.parentNode.label,m.className="group-label",l.appendChild(m)}e.wrapper.non_selected.appendChild(l)}s.parentNode==e&&(l=null,d=null),(!r||r&&c.toLowerCase().indexOf(r.toLowerCase())>-1)&&(null!=l?l.appendChild(p):e.wrapper.non_selected.appendChild(p))}if(t.hide_empty_groups){var h=document.getElementsByClassName("item-group");for(i=0;i<h.length;i++)h[i].childElementCount<2&&(h[i].style.display="none")}};return function(n,r){if((r=void 0!==r?r:{}).enable_search=void 0===r.enable_search||r.enable_search,r.search_placeholder=void 0!==r.search_placeholder?r.search_placeholder:"Search...",r.non_selected_header=void 0!==r.non_selected_header?r.non_selected_header:null,r.selected_header=void 0!==r.selected_header?r.selected_header:null,r.limit=void 0!==r.limit?parseInt(r.limit):-1,isNaN(r.limit)&&(r.limit=-1),r.hide_empty_groups=void 0!==r.hide_empty_groups&&r.hide_empty_groups,r.selected_outer=void 0===r.selected_outer||r.selected_outer,null==n.dataset.multijs&&"SELECT"==n.nodeName&&n.multiple){n.style.display="none",n.setAttribute("data-multijs",!0);var l=document.createElement("div");if(l.className="multi-wrapper",r.enable_search){var d=document.createElement("input");d.className="search-input",d.type="text",d.setAttribute("placeholder",r.search_placeholder),d.setAttribute("title",r.search_placeholder),d.addEventListener("input",function(){a(n,r)}),l.appendChild(d),l.search=d}var i=document.createElement("div");if(i.className="non-selected-wrapper",!1===r.selected_outer&&(i.className=i.className+" non-selected-wrapper-primary"),r.selected_outer){var s=document.createElement("div");s.className="selected-wrapper"}l.addEventListener("click",function(e){e.target.getAttribute("multi-index")&&t(n,e,r)}),l.addEventListener("keypress",function(e){var a=32===e.keyCode||13===e.keyCode;e.target.getAttribute("multi-index")&&a&&(e.preventDefault(),t(n,e,r))}),l.appendChild(i),r.selected_outer&&l.appendChild(s),l.non_selected=i,r.selected_outer&&r.selected_outer&&(l.selected=s),n.wrapper=l,n.parentNode.insertBefore(l,n.nextSibling);for(var o=0;o<n.options.length;o++){var c=n.options[o];c.setAttribute("data-origin-disabled",c.disabled)}e(n,r),a(n,r),n.addEventListener("change",function(){a(n,r)})}}}();"undefined"!=typeof jQuery&&function(e){e.fn.multi=function(t){return t=void 0!==t?t:{},this.each(function(){var a=e(this);multi(a.get(0),t)})}}(jQuery);export default multi;